<!DOCTYPE html>
<html>
  <head>
    <title>hmacsha256.html</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" 
          href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script type='text/javascript'
            src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
 
    <script type='text/javascript'
            src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <script type='text/javascript'
            src="http://crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/hmac-sha256.js"></script>

    <script type='text/javascript'
            src="//crypto-js.googlecode.com/svn/tags/3.1.2/build/components/core-min.js"></script>
    <script type='text/javascript'
            src="//crypto-js.googlecode.com/svn/tags/3.1.2/build/components/enc-utf16-min.js"></script>
    <script type='text/javascript'
            src="//crypto-js.googlecode.com/svn/tags/3.1.2/build/components/enc-base64-min.js"></script>

    <style type='text/css'>
     body {
       font-size: 180%;
     }
     .notshown {
       display: none;
     }
     .shown {
       display: block;
     }
     form div label {
       float: left;
       width: 148px;
       margin: 8px 0;
     }
     form > div > select,
     form > div > textarea,
     form > div > input {
       float: left;
       max-width: 660px;
       margin: 2px 0;
     }
     form > div,
     form > div.form-group {
       display:block;
       clear:both;
     }
     #output, #notes {
       display:block;
       border-color: White;
       border-style: solid;
       border-width: 1px;
       margin-top: 32px;
     }
     #notes {
       font-size:80%;
       color: #565656;
     }
     #output > div  {
       margin-top: 16px;
     }
     #output > div > div {
       border: 1px dotted Grey;
       max-width: 660px;
       margin: 2px 0;
       padding:4px 10px;
     }
     .disabled {
       color:  #F1F1f1;
       background: none repeat scroll 0 0 #DCDCDC;
       cursor: default !important;
     }
     input[type="radio"] {
       vertical-align: middle; 
       margin-top: 8px; 
     }
     input[type="radio"] + div {
       display:block;
       margin-left:166px;
     }

    </style>

    <script type='text/javascript'>

     function calcHmac() {
       var message = $('#text').val();
       var key = $('#key').val();
       if (message && key) {
         var hmac = CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256, key);
         hmac.update(message);
         var hash = hmac.finalize();
         var hashInBase64 = CryptoJS.enc.Base64.stringify(hash);
         $('#resultb64').text(hashInBase64);
         var hashInHex = CryptoJS.enc.Hex.stringify(hash);
         $('#resulthex').text(hashInHex);
       }
       else {
         $('#resulthex').text('You must specify a message and a key');
         $('#resultb64').text('error');
       }
       $('#resultb64').addClass('shown');
       $('#resultb64').removeClass('notshown');
       $('#resulthex').addClass('shown');
       $('#resulthex').removeClass('notshown');
     }

     function calcSha() {
       var message = $('#text').val();
       if (message) {
         var hash = CryptoJS.SHA256(message);
         var hashInBase64 = CryptoJS.enc.Base64.stringify(hash);
         $('#resultb64').text(hashInBase64);
         var hashInHex = CryptoJS.enc.Hex.stringify(hash);
         $('#resulthex').text(hashInHex);

         $('#resultb64').addClass('shown')
                        .removeClass('notshown');
         $('#resulthex').addClass('shown')
                        .removeClass('notshown');
       }
     }

     function calcResult(event) {
       if (event) { event.preventDefault(); }
       var calc = $('input[name="computation"]:checked', '#form1').val();
       if (calc == 'hmac-sha256') { 
         calcHmac();
       }
       else { 
         calcSha();
       }
     }

     function changeFunction(event) {
       if (event) { event.preventDefault(); }
       // enable the compute button
       $( "#submit" ).removeClass('disabled')
                     .prop("disabled", false); 

       // erase the results
       $('#resulthex').text('')
                     .addClass('notshown')
                     .removeClass('shown');
       $('#resultb64').text('')
                     .addClass('notshown')
                     .removeClass('shown');
                  

       // display or hide the key as appropriate
       var calc = $('input[name="computation"]:checked', '#form1').val();
       if (calc == 'hmac-sha256') { 
         $('#key').addClass('shown')
                  .removeClass('notshown');
         $('#keylabel').addClass('shown')
                  .removeClass('notshown');
         $( "#key" ).removeClass('disabled')
                         .prop("disabled", false); 
       }
       else { 
         $('#key').addClass('notshown')
                  .removeClass('shown');
         $('#keylabel').addClass('notshown')
                  .removeClass('shown');
         $( "#key" ).addClass('disabled')
                         .prop("disabled", true); 
       }
     }

     $(document).ready(function() {
       $('input[name="computation"]', '#form1').prop('checked', false);
       $('#form1 input[type=radio]').change(changeFunction);
       $( "#submit" ).on('click',calcResult);
     });
    </script>

  </head>

  <!-- ======================================================= -->

  <body>

    <div style='margin: 10px;'>
      <h3>Calculate a SHA-256, or an HMAC with SHA-256</h3>

      <form role='form' id='form1'>
        <div class='form-group'>
          <label for='computation'>function:</label>
          <input type="radio"  name="computation" value="sha256" /> <div>sha256</div>

          <input type="radio" name="computation" value="hmac-sha256" /> <div>hmac-sha256</div>
        </div>

        <div class='form-group'>
          <label for='text'>text or message:</label>
        <!-- input type='textarea' id='text' class='form-control'  -->
          <textarea class="form-control" rows="5" id='text' 
                 placeholder="insert your message here"
                    title='The message to use in the function. This data never leaves your browser.'></textarea>
        </div>
        <div class='form-group'>
          <label for='key' id='keylabel'>secret key:</label>
          <input type='text' id='key' class='form-control disabled' disabled
                 placeholder="secret key"
                 title='The key or password for the HMAC. This data never leaves your browser.'/>
        </div>

        <div class='form-group'>
          <input type='submit' value='compute' class='button disabled' id='submit' disabled/>
        </div>
      </form>

      <div id='output'>

        <div>
          <span id='resultlabel'>Base64-encoded result:</span>
          <div id='resultb64' title='base64 encoding is case-sensitive' 
               class='notshown'></div>
        </div>

        <div>
          <span id='resultlabel2'>HEX-encoded result:</span>
          <div id='resulthex' title='hex encoding is case-insensitive' 
               class='notshown'></div>
        </div>

      </div>

      <div id='notes'>
        Notes:
        <ol>
          <li>The hex and base64 results are different encodings that represent the same value.</li>
          <li>The key is used only for HMAC calculation. </li>
          <li>SHA: Using the value of <tt>abc</tt> for the messsage, the base64-encoded representation of the sha256 is <tt>ungWv48Bz+pBQUDeXa4iI7ADYaOWF3qctBD/YfIAFa0=</tt> </li>
          <li>HMAC: Using the values of <tt>abc</tt> for the messsage, and <tt>secret</tt> for the key, the base64-encoded hmac-sha256 is <tt>mUba1OAOkT/Ivo5dP34RCkqegy+D+wnDRShdeGONig4=</tt> </li>
          <li>The base64-encoded value is case sensitive. The hex-encoded result is not. </li>
        </ol>
      </div>
    </div>

  </body>

</html>
