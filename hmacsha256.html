<!DOCTYPE html>
<html>
  <head>
    <title>hmacsha256.html</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" 
          href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script type='text/javascript'
            src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
 
    <script type='text/javascript'
            src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <script type='text/javascript'
            src="http://crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/hmac-sha256.js"></script>

    <script type='text/javascript'
            src="//crypto-js.googlecode.com/svn/tags/3.1.2/build/components/core-min.js"></script>
    <script type='text/javascript'
            src="//crypto-js.googlecode.com/svn/tags/3.1.2/build/components/enc-utf16-min.js"></script>
    <script type='text/javascript'
            src="//crypto-js.googlecode.com/svn/tags/3.1.2/build/components/enc-base64-min.js"></script>

    <style type='text/css'>
     body {
       font-size: 180%;
     }
     .notshown {
       display: none;
     }
     .shown {
       display: block;
     }
     form div label {
       float: left;
       width: 148px;
       margin: 8px 0;
     }
     form > div > select,
     form > div > input {
       float: left;
       max-width: 660px;
       margin: 2px 0;
     }
     form > div,
     form > div.form-group {
       display:block;
       clear:both;
     }
     #output {
       margin-top: 32px;
     }
     #output > div  {
       margin-top: 16px;
     }
     #output > div > div {
       border: 1px dotted Grey;
       max-width: 660px;
       margin: 2px 0;
       padding:4px 10px;
     }
    </style>

    <script type='text/javascript'>
     function calcHmac(event) {
       if (event) {
         event.preventDefault();
       }
       var message = $('#text').val();
       var key = $('#key').val();
       var hmac = CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256, key);

       hmac.update(message);
       var hash = hmac.finalize();
       var hashInBase64 = CryptoJS.enc.Base64.stringify(hash);
       $('#hmacb64').text(hashInBase64);
       var hashInHex = CryptoJS.enc.Hex.stringify(hash);
       $('#hmachex').text(hashInHex);

       $('#hmacb64').addClass('shown');
       $('#hmacb64').removeClass('notshown');
       $('#hmachex').addClass('shown');
       $('#hmachex').removeClass('notshown');
     }

     $(document).ready(function() {
       $( "#submit" ).on('click',calcHmac);
     });
    </script>

  </head>

  <!-- ======================================================= -->

  <body>

    <div style='margin: 10px;'>
      <h3>Calculate an HMAC using SHA-256</h3>

      <form role='form'>
        <div class='form-group'>
          <label for='text'>text or message:</label>
          <input type='textarea' id='text' class='form-control' 
                 title='The message to compute the HMAC for. This data never leaves your browser.'/>
        </div>
        <div class='form-group'>
          <label for='key'>key:</label>
          <input type='text' id='key' class='form-control'
                 title='The key or password for the HMAC. This data never leaves your browser.'/>
        </div>
        <div class='form-group'>
          <input type='submit' value='compute hmac' class='button' id='submit'/>
        </div>
      </form>

      <div id='output'>

        <div>
          <span id='hmaclabel'>Base64-encoded HMAC-SHA256:</span>
          <div id='hmacb64' title='base64 encoding is case-sensitive' 
               class='notshown'></div>
        </div>

        <div>
          <span id='hmaclabel2'>HEX-encoded HMAC-SHA256:</span>
          <div id='hmachex' title='hex encoding is case-insensitive' 
               class='notshown'></div>
        </div>

      </div>
    </div>

  </body>

</html>
