<!doctype html>
<html lang="en">
  <head>
    <title>TOTP Link Builder</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

    <link rel="stylesheet" type="text/css" href="css/main.css" />

    <script type="text/javascript" src="js/base32.js"></script>
    <script type="text/javascript" src="js/link-builder-page.js"></script>
  </head>
  <body>
    <!-- ======================================================= -->
    <div style="margin: 10px">
      <h3>
        Get a TOTP barcode (<a href="https://tools.ietf.org/html/rfc6238"
          >IETF RFC 6238</a
        >)
      </h3>
      <form role="form">
        <div class="form-group">
          <label for="baseurl">Base URL:</label>
          <select
            name="baseurl"
            id="baseurl"
            class="form-control"
            data-placeholder="baseurl"
            required
          >
            <option value=""></option>
            <option value="https://quickchart.io/qr">
              https://quickchart.io/qr
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="bcsize">size:</label>
          <select
            name="bcsize"
            id="bcsize"
            class="form-control"
            data-placeholder="bcsize"
            required
          >
            <option value=""></option>
            <option value="200">200</option>
            <option value="320">320</option>
            <option value="480">480</option>
          </select>
        </div>

        <div class="form-group">
          <label for="label">Label:</label>
          <input type="text" class="form-control" id="label" />
        </div>

        <div class="form-group">
          <label for="secret">Secret:</label>
          <input
            type="text"
            class="form-control"
            id="secret"
            title="Be careful. This page does not store or log the secret, but you can never be too sure, can you?"
          />
        </div>

        <div class="form-group">
          <label for="issuer">Issuer:</label>
          <input type="text" class="form-control" id="issuer" />
        </div>

        <div>
          <button type="submit" class="btn btn-default" style="display: none">
            Submit
          </button>
        </div>
      </form>

      <div
        class="modal fade"
        id="notes-modal"
        tabindex="-1"
        aria-labelledby="notesModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Notes</h5>
              <button
                type="button"
                class="close"
                data-bs-dismiss="modal"
                aria-label="Close"
              >
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <ol>
                <li>
                  <p>
                    This page generates a QR code (barcode) that can be used for
                    an authenticator app that generates and display Time-based
                    One Time Passwords (TOTP). Such apps include
                    <a
                      href="https://www.google.com/search?q=google+authenticator"
                      >Google Authenticator</a
                    >,
                    <a
                      href="https://www.google.com/search?q=microsoft+authenticator"
                      >Microsoft Authenticator</a
                    >, and numerous others. The basic idea is that you, as a
                    user, visit a website, the website challenges you for the
                    one-time passcode, and you open the authenticator app on
                    your phone and see the code. Websites generate a unique QR
                    code as the way to "install" the TOTP generator particular
                    for that user&amp;website combination on your mobile device.
                  </p>
                </li>

                <li>
                  <p>
                    This webpage lets you generate a QR codes by assembling the
                    data you enter here for Label, Secret, and Issuer, into a
                    URL, that then gets sent to quickchart.io. You can then scan
                    the generated code with your mobile device, to install the
                    TOTP generator in your preferred authenticator app. But
                    <strong
                      >you should use this only for demonstrations.</strong
                    >
                  </p>
                </li>

                <li>
                  <p>
                    The QR code you generate here should be used for example or
                    demonstration purposes only. This is because the combination
                    of {Label, Secret, and Issuer} are sufficient information
                    for any holder to generate their own QR code, and thus
                    "impersonate you". By using this webpage to generate a
                    barcode, you are sharing your keys with quickchart.io (or
                    whatever service you use). In other words, never use an
                    online tool to generate a QR code for TOTP. For a more
                    detailed explanation, see
                    <a href="https://stackoverflow.com/a/56737468/48082"
                      >this stackoverflow answer</a
                    >.
                  </p>
                </li>

                <li>
                  <p>
                    This webpage does not provide a way to validate a TOTP
                    generated from your app, sorry.
                  </p>
                </li>

                <li>
                  <p>
                    This tool uses EcmaScript (JavaScript) for interactivity,
                    and
                    <a
                      href="https://getbootstrap.com/docs/5.3/getting-started/introduction/"
                      >Bootstrap v5</a
                    >
                    for styling. It will run only on modern, current browsers.
                  </p>
                </li>

                <li>
                  <p>
                    Written by
                    <a href="https://github.com/DinoChiesa/">Dino Chiesa</a>.
                    Contact me with questions, suggestions, or kudos via
                    <a href="https://bsky.app/profile/ionicshade.bsky.social"
                      >Bsky</a
                    >.
                  </p>
                </li>
              </ol>
            </div>

            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Close
              </button>
              <!--        <button type="button" class="btn btn-primary">Save changes</button> -->
            </div>
          </div>
        </div>
      </div>

      <div id="output">
        <div id="totplinkholder"><a href="" id="totplink"></a></div>
        <div id="buttons">
          <button
            class="btn btn-default show-btn"
            id="show-barcode"
            title="Show the barcode"
          >
            Show
          </button>
          <button class="btn btn-default" id="reset-everything">Reset</button>
          <button class="btn btn-default" id="show-notes" title="show notes">
            Notes
          </button>
        </div>
        <div id="barcodeResult"></div>
      </div>
    </div>
  </body>
</html>
