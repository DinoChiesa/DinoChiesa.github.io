<!doctype html>
<html lang="en">
  <head>
    <title>Generic OIDC URL-builder Form</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="favico-signin.svg" type="image/svg+xml" />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/choices.js@9.0.1/public/assets/styles/choices.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/choices.js@9.0.1/public/assets/scripts/choices.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/main.css" />

    <script type="text/javascript">
      let html5AppId = "D8E7329D-7F0E-4E40-AF47-2BED473C8837";
    </script>

    <script type="text/javascript" src="js/oidc-url-builder-page.js"></script>
  </head>
  <body>
    <!-- build the URL ======================================================= -->
    <div style="margin: 10px">
      <h3>
        Build link for OIDC Sign-in
        <div class="form-check form-switch dm-switch mt-3">
          <input
            class="form-check-input"
            type="checkbox"
            role="switch"
            id="dark-mode-toggle"
          />
          <label class="form-check-label" for="dark-mode-toggle"
            >Dark Mode</label
          >
        </div>
      </h3>
      <div class="d-flex mb-2">
        <div class="dropdown" style="margin-right: 6px">
          <button
            class="btn btn-outline-secondary"
            type="button"
            id="btn-config-menu"
            data-bs-toggle="dropdown"
            aria-expanded="false"
            title="Configuration Management"
          >
            <i class="bi bi-gear"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="btn-config-menu">
            <li>
              <a class="dropdown-item" href="#" id="btn-save-config">Save...</a>
            </li>
            <li>
              <a class="dropdown-item" href="#" id="btn-load-config">Load...</a>
            </li>
            <li>
              <a class="dropdown-item" href="#" id="btn-delete-config"
                >Delete...</a
              >
            </li>
          </ul>
        </div>
        <h4 id="current-config-name" class="text-muted fw-light"></h4>
      </div>
      <form role="form">
        <div class="form-group">
          <label for="baseloginurl">base URL:</label>
          <input
            type="text"
            class="form-control"
            id="baseloginurl"
            placeholder="https://login.salesforce.com/services/oauth2/authorize"
            title="eg, https://login.salesforce.com/services/oauth2/authorize"
          />
        </div>
        <div class="form-group">
          <label for="clientid">client ID:</label>
          <input
            type="text"
            class="form-control"
            id="clientid"
            placeholder="e8b3b2174a8b8f3debf171f6b6bf"
          />
        </div>
        <div class="form-group">
          <label for="clientsecret">client secret:</label>
          <input
            type="text"
            class="form-control"
            id="clientsecret"
            placeholder="590d5426191846c5ae5c373d04e28f84"
          />
        </div>
        <div class="form-group">
          <div>
            <label for="state">state:</label>
            <button
              type="button"
              class="btn btn-outline-secondary btn-sm btn-reload"
              data-target="state"
              title="regenerate random"
            >
              <i class="bi bi-arrow-clockwise"></i>
            </button>
          </div>
          <input type="text" class="form-control" id="state" />
        </div>
        <div class="form-group">
          <div>
            <label for="nonce">nonce:</label>
            <button
              type="button"
              class="btn btn-outline-secondary btn-sm btn-reload"
              data-target="nonce"
              title="regenerate random"
            >
              <i class="bi bi-arrow-clockwise"></i>
            </button>
          </div>
          <input type="text" class="form-control" id="nonce" />
        </div>
        <div class="form-group">
          <label for="cburi">callback URI:</label>
          <input
            type="text"
            class="form-control"
            id="cburi"
            value="https://dinochiesa.github.io/openid-connect/oidc-callback-handler.html"
          />
        </div>
        <div class="form-group">
          <label for="rtype">response type:</label>
          <select
            multiple
            name="rtype"
            id="rtype"
            class="multi-choice rtype"
            data-placeholder="response type"
            required
          >
            <option value=""></option>
            <option value="code">code</option>
            <option value="token">token</option>
            <option value="id_token">id_token</option>
            <option value="invalid_option">invalid_option</option>
          </select>
        </div>
        <div class="form-group">
          <label for="scope">scope:</label>
          <select
            name="scope"
            id="scope"
            multiple
            class="multi-choice scope"
            data-placeholder="scope"
            required
          >
            <option value=""></option>
            <option value="openid">openid</option>
            <option value="profile">profile</option>
            <option value="email">email</option>
            <option value="invalid_option">invalid_option</option>
          </select>
        </div>
        <div class="form-group">
          <div>
            <label for="audience">audience:</label>
            <select
              class="select-modifier"
              id="audience-or-resource"
              title="name to use for query param in /authorize URL"
            >
              <option value="none">None</option>
              <option value="audience" selected>audience</option>
              <option value="resource">resource</option>
            </select>
          </div>
          <input
            type="text"
            class="form-control"
            id="audience"
            placeholder="api://your-api-identifier"
            title="The audience for the token"
          />
        </div>
        <div class="form-group">
          <label for="tokenpath">token path/URI:</label>
          <input
            type="text"
            class="form-control"
            id="tokenpath"
            value="/token"
            title="path eg, /oauth2/token, or full URI"
          />
        </div>
        <div class="form-group">
          <div>
            <label for="code">code:</label>
          </div>
          <input
            type="text"
            title="paste in the code here..."
            class="form-control"
            id="code"
          />
        </div>
        <div>
          <button type="submit" class="btn btn-default" style="display: none">
            Submit
          </button>
        </div>
      </form>

      <div id="output">
        <div><a href="" id="authzlink"></a></div>
        <button
          type="button"
          class="btn btn-primary"
          id="btn-signin"
          title="Open the sign-in link in a popup window"
        >
          Sign In
        </button>
        <div id="authzRedemption">
          <div id="preBox"></div>
          <button
            class="btn btn-outline-secondary btn-md"
            id="btn-copy"
            data-target="preBox"
            title="Copy the curl command to the clipboard"
          >
            Copy curl
          </button>
          <!--
        Â¿porque no?
        -->
          <button
            class="btn btn-outline-secondary btn-md"
            id="btn-redeem"
            title="invoke the code redemption from the browser"
          >
            Redeem
          </button>
          <button class="btn btn-outline-secondary btn-md" id="btn-reset">
            Reset
          </button>
        </div>
        <div id="token-decoded"></div>
      </div>
    </div>

    <!-- Save Configuration Modal -->
    <div
      class="modal fade"
      id="saveConfigModal"
      tabindex="-1"
      aria-labelledby="saveConfigModalLabel"
      aria-hidden="true"
    >
      <div class="modal-lg modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="saveConfigModalLabel">
              Save Configuration
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="mb-3">
                <label for="config-name" class="col-form-label"
                  >Configuration Name:</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="config-name"
                  list="config-names-list"
                />
                <datalist id="config-names-list"></datalist>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="btn-do-save-config"
            >
              Save
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Load Configuration Modal -->
    <div
      class="modal fade"
      id="loadConfigModal"
      tabindex="-1"
      aria-labelledby="loadConfigModalLabel"
      aria-hidden="true"
    >
      <div class="modal-lg modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="loadConfigModalLabel">
              Load Configuration
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p>Select a saved configuration to load.</p>
            <select class="form-select" id="config-select">
              <option selected>--No configurations saved--</option>
            </select>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="btn-do-load-config"
            >
              Load
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Delete Configuration Modal -->
    <div
      class="modal fade"
      id="deleteConfigModal"
      tabindex="-1"
      aria-labelledby="deleteConfigModalLabel"
      aria-hidden="true"
    >
      <div class="modal-lg modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="deleteConfigModalLabel">
              Delete Configuration
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p>
              Select a saved configuration to delete. This cannot be undone.
            </p>
            <select class="form-select" id="config-delete-select">
              <option selected>--No configurations saved--</option>
            </select>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-danger"
              id="btn-do-delete-config"
            >
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
