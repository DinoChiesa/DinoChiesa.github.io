<!doctype html>
<html lang="en">
  <head>
    <title>Generic OIDC Login URL-builder Form</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdnjs.cloudflare.com/ajax/libs/open-iconic/1.1.1/font/css/open-iconic-bootstrap.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/choices.js@9.0.1/public/assets/styles/choices.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/choices.js@9.0.1/public/assets/scripts/choices.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/main.css" />

    <script type="text/javascript">
      let html5AppId = "D8E7329D-7F0E-4E40-AF47-2BED473C8837";
    </script>

    <script type="text/javascript" src="js/oidc-login-page.js"></script>
  </head>
  <body>
    <!-- ======================================================= -->
    <div style="margin: 10px">
      <h3>Build link for OIDC Sign-in</h3>
      <div class="d-flex mb-2">
        <!-- justify-content-end  -->
        <button
          type="button"
          class="btn btn-outline-secondary me-2"
          id="btn-save-config"
        >
          Save...
        </button>
        <button
          type="button"
          class="btn btn-outline-secondary"
          id="btn-load-config"
        >
          Load...
        </button>
      </div>
      <form role="form">
        <div class="form-group">
          <label for="baseloginurl">Base URL:</label>
          <input
            type="text"
            class="form-control"
            id="baseloginurl"
            placeholder="https://login.salesforce.com/services/oauth2/authorize"
            title="eg, https://login.salesforce.com/services/oauth2/authorize"
          />
        </div>
        <div class="form-group">
          <label for="clientid">Client ID:</label>
          <input
            type="text"
            class="form-control"
            id="clientid"
            placeholder="e8b3b2174a8b8f3debf171f6b6bf"
          />
        </div>
        <div class="form-group">
          <label for="clientsecret">Client Secret:</label>
          <input
            type="text"
            class="form-control"
            id="clientsecret"
            placeholder="590d5426191846c5ae5c373d04e28f84"
          />
        </div>
        <div class="form-group">
          <div>
            <label for="audience">Audience:</label>
            <input class="form-check-input" type="checkbox" id="use_audience" />
          </div>
          <input
            type="text"
            class="form-control"
            id="audience"
            placeholder="api://your-api-identifier"
            title="The audience for the token"
          />
        </div>
        <div class="form-group">
          <div>
            <label for="state">state</label>
            <button
              type="button"
              class="btn btn-outline-secondary btn-sm btn-reload"
              data-target="state"
              title="regenerate random"
            >
              <span class="oi oi-reload"></span>
            </button>
          </div>
          <input type="text" class="form-control" id="state" />
        </div>
        <div class="form-group">
          <div>
            <label for="nonce">nonce:</label>
            <button
              type="button"
              class="btn btn-outline-secondary btn-sm btn-reload"
              data-target="nonce"
              title="regenerate random"
            >
              <span class="oi oi-reload"></span>
            </button>
          </div>
          <input type="text" class="form-control" id="nonce" />
        </div>
        <div class="form-group">
          <label for="cburi">callback URI:</label>
          <input
            type="text"
            class="form-control"
            id="cburi"
            value="https://dinochiesa.github.io/openid-connect/oidc-callback-handler.html"
          />
        </div>
        <div class="form-group">
          <label for="tokenpath">Token Path:</label>
          <input
            type="text"
            class="form-control"
            id="tokenpath"
            value="/token"
            title="eg, /oauth2/token"
          />
        </div>
        <div class="form-group">
          <label for="rtype">response type:</label>
          <select
            multiple
            name="rtype"
            id="rtype"
            class="multi-choice rtype"
            data-placeholder="response type"
            required
          >
            <option value=""></option>
            <option value="code">code</option>
            <option value="token">token</option>
            <option value="id_token">id_token</option>
            <option value="invalid_option">invalid_option</option>
          </select>
        </div>

        <div class="form-group">
          <label for="scope">scope:</label>
          <select
            name="scope"
            id="scope"
            multiple
            class="multi-choice scope"
            data-placeholder="scope"
            required
          >
            <option value=""></option>
            <option value="openid">openid</option>
            <option value="profile">profile</option>
            <option value="email">email</option>
            <option value="invalid_option">invalid_option</option>
          </select>
        </div>
        <div class="form-group">
          <div>
            <label for="code">code</label>
          </div>
          <input
            type="text"
            title="paste in the code here..."
            class="form-control"
            id="code"
          />
        </div>
        <div>
          <button type="submit" class="btn btn-default" style="display: none">
            Submit
          </button>
        </div>
      </form>

      <div id="output">
        <a href="" id="authzlink"></a>
        <div id="authzRedemption">
          <div id="preBox"></div>
          <button
            class="btn btn-outline-secondary btn-md"
            id="btn-copy"
            data-target="preBox"
            title="Copy the curl command to the clipboard"
          >
            Copy curl
          </button>
          <!--
        Â¿porque no?
        -->
          <button
            class="btn btn-outline-secondary btn-md"
            id="btn-redeem"
            title="invoke the code redemption from the browser"
          >
            Redeem
          </button>
          <button class="btn btn-outline-secondary btn-md" id="btn-reset">
            Reset
          </button>
        </div>
        <div id="token-decoded"></div>
      </div>
    </div>

    <!-- Save Configuration Modal -->
    <div
      class="modal fade"
      id="saveConfigModal"
      tabindex="-1"
      aria-labelledby="saveConfigModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="saveConfigModalLabel">
              Save Configuration
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="mb-3">
                <label for="config-name" class="col-form-label"
                  >Configuration Name:</label
                >
                <input type="text" class="form-control" id="config-name" list="config-names-list" />
                <datalist id="config-names-list"></datalist>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="btn-do-save-config"
            >
              Save
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Load Configuration Modal -->
    <div
      class="modal fade"
      id="loadConfigModal"
      tabindex="-1"
      aria-labelledby="loadConfigModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="loadConfigModalLabel">
              Load Configuration
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p>Select a saved configuration to load.</p>
            <select class="form-select" id="config-select">
              <option selected>--No configurations saved--</option>
            </select>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="btn-do-load-config"
            >
              Load
            </button>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
