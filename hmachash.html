<!DOCTYPE html>
<html>
  <head>
    <title>HMAC and SHA calculator</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/base-min.css">
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">
    <link rel="stylesheet" type="text/css"
          href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script type='text/javascript'
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"</script>
    <script type='text/javascript'
            src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <script type='text/javascript'
            src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/hmac-md5.js"></script>
    <script type='text/javascript'
            src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/hmac-sha1.js"></script>
    <script type='text/javascript'
            src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/hmac-sha224.js"></script>
    <script type='text/javascript'

            src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/hmac-sha256.js"></script>
    <script type='text/javascript'
            src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/hmac-sha384.js"></script>

    <script type='text/javascript'
            src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/hmac-sha512.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/md5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/sha1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/sha224.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/sha256.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/sha384.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/sha512.js"></script>

    <script type='text/javascript'
            src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/core-min.js"></script>
    <script type='text/javascript'
            src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/enc-utf16-min.js"></script>
    <script type='text/javascript'
            src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/components/enc-base64-min.js"></script>

    <style type='text/css'>
     body {
       font-size: 180%;
     }
     body > div {
       display: flex;
       height: auto;
       max-width: 1440px;
       margin: 0 auto;
     }
     form div label {
       float: left;
       width: 148px;
       margin: 8px 0;
     }
     form > div > select,
     form > div > textarea,
     form > div > input {
       float: left;
       max-width: 860px;
       margin: 2px 0;
     }
     form > div,
     form > div.form-group {
       display:block;
       clear:both;
     }
     #output, #notes {
       display:block;
       border-color: White;
       border-style: solid;
       border-width: 1px;
       margin-top: 54px;
     }
     #notes {
       border-top:  thick double #32a1ce;
     }
     #notes {
       font-size:80%;
       color: #565656;
     }
     #output > div {
       margin-top: 16px;
     }
     #output > div > span {
       display:block;
       width: 228px;
     }
     #output > div > div:last-of-type {
       border: 1px dotted Grey;
       max-width: 1248px;
       width: 1248px;
       margin: 2px 0;
       padding: 4px 10px;
       font-size: 75%;
       float: left;
     }
     .code {
       font-family: "Consolas", "Courier New", Courier, monospace;
     }
     #key.notshown,
     #keylabel.notshown,
     #output.notshown > div > div {
       display: none;
     }
     #key.shown,
     #keylabel.shown,
     #output.shown > div > div {
       display: block;
     }
     #output > div > .copyIconHolder {
       /* https://material.io/icons/#ic_content_copy */
       content: url('images/ic_content_copy_black_24dp_1x.png');
       padding-right: 5px;
       float: left;
       margin-top: 4px;
     }
     #output > div:after {
       content: "";
       display: table;
       clear: both;
     }
     .disabled {
       color:  #F1F1f1;
       background: none repeat scroll 0 0 #DCDCDC;
       cursor: default !important;
     }
     input[type="radio"] {
       vertical-align: middle;
       margin-top: 8px;
     }
     input[type="radio"] + div {
       display:block;
       margin-left:166px;
     }
     input[type="checkbox"] {
       vertical-align: middle;
       margin-top: 14px;
     }
     form > div > select {max-width:120px;}
    </style>

    <script type='text/javascript'>
     function getAlgo() {
       var algorithm = $('#function option:selected').val();
       switch (algorithm) {
         case 'md-5':
           return CryptoJS.algo.MD5;
           break;
         case 'sha-1':
           return CryptoJS.algo.SHA1;
           break;
         case 'sha-224':
           return CryptoJS.algo.SHA224;
           break;
         case 'sha-256':
           return CryptoJS.algo.SHA256;
           break;
         case 'sha-384':
           return CryptoJS.algo.SHA384;
           break;
         case 'sha-512':
           return CryptoJS.algo.SHA512;
           break;
       }
       throw { error: 'unsupported algorithm.'};
     }

     function getHash(message) {
       var algorithm = $('#function option:selected').val();
       switch (algorithm) {
         case 'md-5':
           return CryptoJS.MD5(message);
           break;
         case 'sha-1':
           return CryptoJS.SHA1(message);
           break;
         case 'sha-224':
           return CryptoJS.SHA224(message);
           break;
         case 'sha-256':
           return CryptoJS.SHA256(message);
           break;
         case 'sha-384':
           return CryptoJS.SHA384(message);
           break;
         case 'sha-512':
           return CryptoJS.SHA512(message);
           break;
       }
       throw { error: 'unsupported algorithm.'};
     }

     function calcHmac() {
       var message = $('#text').val();
       var key = $('#key').val();
       if (message!=null && key) {
         var re1 = new RegExp('(\r\n|\n)', 'g');
         message = message.replace(re1,'\n');
         var hmac = CryptoJS.algo.HMAC.create(getAlgo(), key);
         hmac.update(message);
         var hash = hmac.finalize();
         var hashInBase64 = CryptoJS.enc.Base64.stringify(hash);
         $('#resultb64').text(hashInBase64);
         var hashInHex = CryptoJS.enc.Hex.stringify(hash);
         $('#resulthex').text(hashInHex);
       }
       else {
         $('#resulthex').text('You must specify a message and a key');
         $('#resultb64').text('error');
       }
       $('#output').addClass('shown');
       $('#output').removeClass('notshown');
     }

     function calcSha() {
       var message = $('#text').val();
       if (message!=null) {
         var re1 = new RegExp('(\r\n|\n)', 'g');
         message = message.replace(re1,'\n');
         var hash = getHash(message);
         var hashInBase64 = CryptoJS.enc.Base64.stringify(hash);
         $('#resultb64').text(hashInBase64);
         var hashInHex = CryptoJS.enc.Hex.stringify(hash);
         $('#resulthex').text(hashInHex);
         $('#output').addClass('shown').removeClass('notshown');
       }
     }

     function calcResult(event) {
       if (event) { event.preventDefault(); }
       var message = $('#text').val();
       //var re1 = new RegExp('(\r\n|\n)', 'g');
       //alert('message:\n' + message.replace(re1,'\\n\n'));
       if ($('#hmac').is(':checked')) {
         calcHmac();
       }
       else {
         calcSha();
       }
     }

     function changeFunction(event) {
       if (event) { event.preventDefault(); }
       // enable the compute button
       $( "#submit" ).removeClass('disabled')
                         .prop("disabled", false);

       // erase the results
       $('#resulthex').text('');
       $('#resultb64').text('');
       $('#output').addClass('notshown')
                         .removeClass('shown');
     }

     function changeHmac(event) {
       if (event) { event.preventDefault(); }
       // display or hide the key as appropriate
       if ($('#hmac').is(':checked')) {
         $('#key').addClass('shown')
                         .removeClass('notshown');
         $('#keylabel').addClass('shown')
                         .removeClass('notshown');
         $( "#key" ).removeClass('disabled')
                         .prop("disabled", false);
       }
       else {
         $('#key').addClass('notshown')
                         .removeClass('shown');
         $('#keylabel').addClass('notshown')
                         .removeClass('shown');
         $( "#key" ).addClass('disabled')
                         .prop("disabled", true);
       }
     }

     function selectText(element) {
       var doc = document, range, selection;
       if (doc.body.createTextRange) {
         range = document.body.createTextRange();
         range.moveToElementText(element);
         range.select();
       }
       else if (window.getSelection) {
         selection = window.getSelection();
         range = document.createRange();
         range.selectNodeContents(element);
         selection.removeAllRanges();
         selection.addRange(range);
       }
     }

     function copyToClipboard() {
       var $iconDiv = $(this);
       var $textHolder = $iconDiv.next();
       selectText($textHolder[0]);
       try {
         document.execCommand('copy');
       }
       catch(exc1) {
       }
     }

     $(document).ready(function() {
       $('#function').val('');
       $('#function').change(changeFunction);
       $('#hmac').change(changeHmac);
       $('#submit').on('click', calcResult);
       $('.copyIconHolder').on('click', copyToClipboard);
       changeHmac();
     });
    </script>

  </head>

  <!-- ======================================================= -->

  <body>

    <div>
    <div style='margin: 10px;'>
      <h3>Calculate a SHA or MD5, or an HMAC with SHA or MD5</h3>

      <form role='form' id='form1' accept-charset='UTF-8'>
        <div class="form-group">
          <label for="function">hash function:</label>
          <select name="function" id="function" class="form-control">
            <option value="" selected></option>
            <option value="md-5" >md-5</option>
            <option value="sha-1" >sha-1</option>
            <option value="sha-224" >sha-224</option>
            <option value="sha-256" >sha-256</option>
            <option value="sha-384" >sha-384</option>
            <option value="sha-512" >sha-512</option>
          </select>
        </div>

        <div class='form-group'>
          <label for='hmac'>hmac?:</label>
          <input type="checkbox" name="hmac" id='hmac'/>
        </div>

        <div class='form-group'>
          <label for='key' id='keylabel'>secret key:</label>
          <input type='text' id='key' class='form-control disabled' disabled
                 placeholder="secret key"
                 title='The key or password for the HMAC. This data never leaves your browser.'/>
        </div>

        <div class='form-group'>
          <label for='text'>text or message:</label>
        <!-- input type='textarea' id='text' class='form-control'  -->
          <textarea class="form-control" rows="5" id='text'
                 placeholder="-insert your message here-"
                    title='The message to use in the function. This data never leaves your browser.'></textarea>
        </div>

        <div class='form-group'>
          <input type='submit' value='compute' class='button disabled' id='submit' disabled/>
        </div>
      </form>

      <div id='output' class='notshown'>
        <div>
          <span>HEX-encoded result:</span>
          <div class='copyIconHolder' title='click to copy'></div>
          <div id='resulthex' class='code' title='hex encoding is case-insensitive'></div>
        </div>
        <div>
          <span>Base64-encoded result:</span>
          <div class='copyIconHolder' title='click to copy'></div>
          <div id='resultb64' class='code' title='base64 encoding is case-sensitive'></div>
        </div>
      </div>

      <div id='notes'>
        Notes:
        <ol>
          <li>The hex and base64 results shown by this page are different encodings that represent the same value.</li>
          <li>If you specify a key for HMAC, the key is used only for HMAC calculation, and never leaves your browser. </li>
          <li>Here are a few test cases:
            <table class='testcases pure-table pure-table-bordered'>
              <thead>
                <tr><th>Alg</th><th>message</th><th>key</th><th>result</th></tr>
              </thead>
              <tbody>
                <tr><td>SHA-256</td><td>abc</td><td>--</td><td>
                  (hex) <span class='code'>ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad</span><br/>
                  (b64) <span class='code'>ungWv48Bz+pBQUDeXa4iI7ADYaOWF3qctBD/YfIAFa0=</span></td></tr>
              <tr><td>HMAC-sha256 </td><td>abc</td><td>secret</td><td>
                (hex) <span class='code'>9946dad4e00e913fc8be8e5d3f7e110a4a9e832f83fb09c345285d78638d8a0e</span><br/>
                (b64) <span class='code'>mUba1OAOkT/Ivo5dP34RCkqegy+D+wnDRShdeGONig4=</span></td></tr>
              </tbody>
            </table>
          </li>
          <li>Just a reminder, base64-encoded values are case sensitive.  Hex-encoded results are not. This is characteristic of the encodings, not special to this page, or to hash functions or HMACs.</li>
          <li>For message content, Whitespace in the content is significant. Line-breaks will be converted to newline (\n). It's not possible to paste in a carriage-return (CR), because this page strips them. Trailing newlines will not be stripped. And remember, the sha256 for 'abc\n' is completely different from the sha256 for 'abc'.</li>
          <li>Unicode is ok. The calculator will encode the string as UTF-8 bytes before computing the checksum. UTF-8 ought to be good enough for anybody. :) </li>
        </ol>
      </div>
    </div>
    </div>
  </body>

</html>
